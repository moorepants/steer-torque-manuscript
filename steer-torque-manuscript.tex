\documentclass[10pt]{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{booktabs} % for table /toprule, /midrule, etc
\usepackage{pdflscape} % for the big table

% This file will not open in Acrobat Reader 9.x.
% This is an attempted fix:
% http://www.tug.org/pipermail/pdftex/2012-March/008806.html
\pdfobjcompresslevel=0

\begin{document}
\begin{flushleft}
  {\Large
  \textbf{Methods for elimination of crosstalk and inertial effects in bicycle
    steer torque estimation}
  }
  \\
  Jason K. Moore$^{1,\ast}$,
  Mont Hubbard$^{2}$
  \\
  \bf{1} Mechanical Engineering, Cleveland State University, Cleveland, Ohio, USA
  \\
  \bf{2} Mechanical and Aerospace Engineering, University of California at Davis, Davis, California, USA
  \\
  $\ast$ E-mail: Corresponding moorepants@gmail.com
\end{flushleft}

\section*{Abstract}

% TODO : Write an abstract!

\section*{Introduction}

To control a bicycle or motorcycle, the rider's primary means of directing the
vehicle is the application of force to the handlebars which cause the front
frame to rotate relative to the rear frame. The rider can, of course, also use
other more subtle biomechanical movements to influence the trajectory of the
vehicle, especially lighter-weight ones, but it is well known that force
applied to the handlebar give much more control authority than other means
\cite{Weir1972,Aoki1979,Sharp2007,Sharp2008a}.

From a single track vehicle modeling perspective, it is easier to model the
human/machine interface forces at the handlebar as a effectively lumped single
torque about the steer axis which acts between the front and rear frames. Then
the rider is assumed to be inertially part of the rear frame, regardless of
whether the rider is assumed to be rigid or not.

Due to this modeling assumption and the potential of easier measurements, most
experimental measurements of the interface forces between the rider and the
front frame are aimed at estimating the torque generated about the steer axis
of the front frame relative to the rest of the system. These ``direct''
measurements of rider applied steer torque are susceptible to error from two
major causes: (1) the inertial effects from the portion of the front frame which is
located between the sensor and the rider/vehicle interface and (2) cross talk
from rider applied forces other than those which generate steer torque.
Accounting for the error sources are particularly important when the steer
torques are small ($<$~20 Nm or so) as seen in most bicycle maneuevers and
certain motorcycle maneuvers.

In this paper, we review previous methods of steer torque measurement in
bicycles and motorcycles and detail the design and implementation of a bicycle
steer torque measurement system which minimizes the aforementioned cross talk
errors. We then provide the computations needed to correctly compensate for
inertial effects of the front frame and bearing friction to obtain a more
accurate estimate of the rider applied steer torque. Finally, to show the
necessity of this approach, we compare the differences between uncompensated
and compensated steer torque measurements for a large set of bicycle
experiments.

\section*{History of Steer Torque Measurements}

% TODO: add et. al appropriately to the citations with multiple authors.

The earliest single track vehicle steer torque measurements we uncovered were
performed in 1951~\cite{Wilson-Jones1951}. Wilson-Jones developed a set of
motorcycle handlebars mounted in rubber bushings that indicated the direction
and value of torque in real time using an analog sensor much like one found in
a modern beam-style torque wrench. He demonstrated that a torque applied in the
opposite direction of the steer angle is utilized to enter into a turn and
measured torques in normal maneuvers in the range of 4 to 14 Nm. Not long after
this, Kondo~\cite{Kondo1955} was the first to record torque measurements
electronically on a motorcycle for post-experiment analysis. Work in Japan on
motorcycle dynamics grew considerably after World War II due to sanctions on
aircraft research and Kageyama~\cite{Kageyama1959} and Fu~\cite{Fu1965}
continued to improve steer torque measurements in motorcycles and studied
torques in steady turning.

% TODO: need citation on japan world war statement

Eaton~\cite{Eaton1973} was the first to measure and record motorcycle steer
torque in the United States. He attached an additional handlebar above the
stock handlebars with strain gages that produced voltage proportional to the
applied torque around the steer axis. The rider operated the motorcycle
with one hand. He measured steer torques up to 3.4 Nm for straight riding for
speeds of 15 to 30 mph. This led him to conclude that most of the measured
steer torque was due to rider remnant, as opposed to deliberate control. Not
long after this, Weir~\cite{Weir1979a} developed a modular torque sensor which
could be affixed to multiple motorcycles with a $\pm$ 70 Nm range and a 1\%
accuracy with a 10 Hz bandwidth and was careful to reduce crosstalk from other
forces applied to the handlebars. They unfortunately oversized the sensor and
the signal to noise ratio was low for steady turn and straight riding
maneuvers, but they measured torques of -20 to 55 Nm in lane changes. Almost 10
years later, Sugizaki~\cite{Sugizaki1988} measured steer torque in high speed
motorcycle lane change maneuvers and recorded torques between -20 and 20 Nm.

After close to 50 years of motorcycle steer torque measurements, the first
bicycle measurements were made by de Lorenzo~\cite{Lorenzo1997} on a downhill
mountain bicycle which was fitted with a custom strain gauged handlebar that
could effectively measure torques about the bicycle's longitudinal and vertical
axes. His plot of torque measurements show maximum steer torques of 7 Nm and
maximum longitudinal handlebar torques of 15 Nm which demonstrated that
non-steer related forces applied to the handlebars can be significantly higher
that those needed for steering.

Around the turn of the 21st century, Bortoluzzi~\cite{Bortoluzzi2000} designed
a successful motorcycle steer torque transducer in which floating handlebars
engage the fork through a small strain-gaged cantilever beam. This design was
less susceptible to crosstalk than earlier designs. They found torques up to 20
Nm for slalom maneuvers at 40 m/s. Around the same time, James~\cite{James2002}
developed a secondary floating handlebar with an integrated linear load cell to
measure steer torques in an off-road motorcycle for the purposes of identifying
the a model that relates steer torque inputs to the vehicle's kinematics.

In 2003, Cheng~\cite{Cheng2003} completed a comprehensive study on bicycle
steer torque for an undergraduate project. Cheng started by simply attaching a
torque wrench to a bicycle's front frame and made left turns at speeds from 0
to 13 m/s. He found that most steering torques were under 5 Nm. He then
designed a floating handlebar which engaged the steer tube via a linear load
cell, very similar to James' design, configured to measure torques up to 84 Nm.
Cheng found torques up to 1 Nm for steady turning at 4.5 m/s and up to 10 Nm
for sharp turns, confirming that bicycles require much lower torques for
maneuvering than motorcycles and that his sensor was quite oversized.

Iuchi~\cite{Iuchi2006} constructed a bicycle with a steer motor that ``senses''
the rider's input for use in additive control. The rider applied steer torque
was estimated from the motor torque and the handlebar and motor moments of
inertia. Capitani~\cite{Capitani2006} found measured steer torques from an
instrumented scooter between -15 and 40 Nm. Evertse~\cite{Evertse2010} was
perhaps the only person to estimate steer torque from sensors in the handle
grips of a motorcycle that give force measurements directly at the
human-vehicle interface. During his test maneuvers, a maximum of 40 Nm was
observed. In 2010, Teerhuis~\cite{Teerhuis2010} shows measured torques just
under 20 Nm for a motorcycle in slalom maneuvers using a floating handlebar
plus linear load tranducer design similar in design to \cite{James2002} and
\cite{Cheng2003}.

Recently, Cain~\cite{Cain2010,Cain2012} developed an in-the-steer-tube torque
sensor for a bicycle. The measured steer torques in steady turns never exceed
2.4 Nm but he admits that his sensor was 90\% oversized. van den
Ouden~\cite{Ouden2011} developed a bicycle steer torque sensor sensor that was
susceptible to cross talk from other handlebar loads but had a more appropriate
measurement range of $\pm7.5$ Nm. And most recently, \cite{Appelman2012} and
\cite{Peterson2013} developed robotic bicycles in which the steer torque could
be estimated by the motor current and motor properties.

% TODO: recheck van Ouden's measurement range and update here and in the table.

% TODO : Add Kageyama's design from his robot motorcycle (email him and ask
% what pub is best to cite)

Steering torque has been measured in relatively few instances of bicycle
experiments and not that many more for motorcycles. Of these, very few of the
designs may actually measure the true rider applied steer torque, as is defined
in most models. This is more consequential for bicycles than motorcycles
because the small torques used in typical bicycle control are of the order of
5-10 Nm. van den Ouden~\cite{Ouden2011}, in particular, showed how sensitive
the torque measurements are to other handlebar loads. Also, most of these
designs place the sensor somewhere between the rider's hands and the ground
contact point of the wheel. This is a physically ideal way to measure the steer
torque, but apparently no one has accounted for the dynamic inertial effects of
the front frame above the sensor, except maybe Iuchi~\cite{Iuchi2006}.
Evertse~\cite{Evertse2010} may have the only design which mitigates this
inertial compensation issue completely due to the proximity of the sensors to
the rider's hands.

\section*{Classification of Steer Torque Designs}

The various designs mentioned in the previous section can be classified into
two major groups: (1) those which in which the handlebars the rider interacts
with are essentially fixed to the front frame and (2) those in which the
handlebars float with respect to the front frame. And both of these groups can
further be categorized.

\subsection*{Fixed Handlebar Designs}

\begin{description}
  \item[Mechanical] The rider applies a force to the handlebar which causes a
    needle to indicate the torque in real
    time.~\cite{Wilson-Jones1951,Cheng2003,Moore2012}
  \item[Simple Strain Gages] Strain gages are applied to the vehicles stock
    handlebars, typically on the steer column, to maximize estimation of steer
    torque.~\cite{Eaton1973,Lorenzo1997,Capitani2006}
  \item[Load cells in the grips] Multiple degree of freedom load cells connect
    the handlebar grips to the handlebar.~\cite{Evertse2010}
  \item[Single load cell in steer column] A six degree of freedom load cell
    connects the handlebars to the front frame.~\cite{Kageyama?}
  \item[Estimated from motor power] An electrical motor connects the handlebars
    to the fork and the rider applied torque is estimated from motor current
    and voltage.~\cite{Iuchi2006,Appelman2012,Peterson2013}
\end{description}

% TODO: The mechanical type is sorta floating and sorta not. Wilson-Jones is
% fixed through rubber bushings, but a torque wrench may technically be
% floating on bearings.

\subsection*{Floating Handlebar Designs}

The floating designs all share the common feature that the handlebars are
connected to the front frame through a revolute joint aligned with steer axis
and all of the forces and torques are transmitted between the handlebars and the
front frame through a load cell of some sort.

\begin{description}
  \item[Inline torque transducer] The handlebars are separated from the fork,
    each mounted in bearings, and the two are connected by an inline torque
    transducer.~\cite{Weir1979a,Cain2010,Cain2012,Moore2012}
  \item[Linear transducer] The handlebars are separated from the fork, each
    mounted in bearings, and the two are connected through a linear force
    transducer.~\cite{Cheng2003,James2002,Teerhuis2010}
  \item[Cantilever transducer] The handlebars are separated from the fork, each
    mounted in bearings, and the two are connected through a cantilever beam
    force transducer.~ \cite{Bortoluzzi2000,Biral2003,Ouden2011}
\end{description}

% TODO: add all citations to these types.

With this information in hand we decided to frame our design around the
floating handlebar concept with an inline torque transducer but in such a way
that no cross talk could affect the measurement and the inertial effects of the
structure between the rider's hands and the sensor were properly accounted for.
But first, we did some exploratory experiments to determine the appropriate
range of the sensor, as there was not enough data in the literature at the time
for a confident choice.

\begin{landscape}
\begin{table}
  \caption{Summary of Past Torque Measurments}
  \small
  \begin{tabular}{llllllll}
    \toprule
    Citation                              &  Year &     Vehicle &              Type & Sensor Range [Nm] & Max Measured Torque [Nm] &                               Maneuvers & Speed [m/s] \\
    \midrule
    \cite{Wilson-Jones1951}               &  1951 &  motorcycle &  fixed-mechanical &                NR &                       14 &  steady circles, entering/exiting turns &          NR \\
    \cite{Kondo1955}                      &  1955 &  motorcycle &                 ? &                 ? &                        ? &                   steady turns, turning &           ? \\
    \cite{Watanabe1973}                   &  1973 &  motorcycle &                 ? &                 ? &                       10 &                                 evasive &          14 \\
    \cite{Eaton1973}                      &  1973 &  motorcycle &      fixed-strain &                 ? &                      3.4 &     straight riding, roll stabilization &    6.7-13.4 \\
    \cite{Weir1979a}                      &  1979 &  motorcycle &      float-torque &         -70 to 70 &                30 and 55 &          steady turning and lane change &        > 10 \\
    \cite{Aoki1979}                       &  1979 &  motorcycle &                NR &                NR &                       98 &               straight, curving, slalom &       10-30 \\
    \cite{Sugizaki1988}                   &  1988 &  motorcycle &                 ? &                 ? &                       20 &                 high speed lane changes &       17-28 \\
    \cite{Lorenzo1997,Lorenzo1999}        &  1997 &     bicycle &      fixed-strain &       -500 to 500 &                        7 &                downhill mountain biking &         6-9 \\
    \cite{Bortoluzzi2000,Biral2003}       &  2000 &  motorcycle &  float-cantilever &                 ? &                       20 &                  steady turning, slalom &        6-40 \\
    \cite{James2002a,James2002,James2005} &  2002 &  motorcycle &      float-linear &         -30 to 30 &                       35 &                         straight riding &        2-19 \\
    \cite{Cheng2003}                      &  2003 &     bicycle &  fixed-mechanical &                   &         5 (20 on 13 m/s) &                   90 degree right turns &        0-13 \\
    \cite{Cheng2003}                      &  2003 &     bicycle &      float-linear &                84 &                 10 and 1 &          sharp turns and steady circles &         4.5 \\
    \cite{Iuchi2006}                      &  2006 &     bicycle &       fixed-motor &                NR &                       12 &                        straight running &             \\
    \cite{Capitani2006}                   &  2006 &     scooter &      fixed-strain &                NR &                       40 &                 lane change and turning &             \\
    \cite{Evertse2010}                    &  2010 &  motorcycle &       fixed-grips &                   &                       40 &                       obstacle manuever &             \\
    \cite{Teerhuis2010}                   &  2010 &  motorcycle &  float-cantilever &                NR &                       15 &                             steady turn &    8.3-12.5 \\
    \cite{Teerhuis2010}                   &  2010 &  motorcycle &  float-cantilever &                NR &                       20 &                                  slalom &   16.4-18.1 \\
    \cite{Ouden2011}                      &  2011 &     bicycle &  float-cantilever &                 5 &                        5 &               normal riding around town &             \\
    \cite{Moore2012}                      &  2012 &     bicycle &  fixed-mechanical &                   &                        5 &          steady circles, lane changes,  &             \\
    \cite{Cain2010,Cain2012}              &  2012 &     bicycle &      float-torque &    90\% oversized &                      2.4 &                            steady turns &             \\
    \cite{Moore2012}                      &  2012 &     bicycle &      float-torque &                   &   reported in this paper &           straight riding, lane changes &             \\
    \cite{Kageyama}                       &     ? &  motorcycle &         fixed-six &                   &                          &                                         &             \\
    \bottomrule
  \end{tabular}
  \label{tab:design}
\end{table}
\end{landscape}

\section*{Estimations of Bicycle Steer Torque Range}

Following in Wilson-Jones'~\cite{Wilson-Jones1951} and Cheng’s~\cite{Cheng2003}
footsteps, we used an accurate torque wrench as an auxiliary handlebar to get
an idea of the maximum torques we would see during a variety of maneuvers. We
designed a simple attachment to the steer tube that allowed easy connection of
3/8'' torque wrenches, Figure~\ref{fig:torque-wrench-instrumentation}. A small
video camera was mounted to the bicycle such that it could view the dial
indicator on the torque wrench, the handlebars, and the digital speedometer
from a viewpoint relative to the bicycle frame,
Figure~\ref{fig:torque-wrench-instrumentation}.  The torque wrench (CDI Torque
Products 751LDIN) had a range of 1.7 Nm to 8.5 Nm and a accuracy of $\pm2$\% of
full scale ($\pm0.17$ Nm) for static measurements,
Figure~\ref{fig:torque-wrench-instrumentation}. The bicycle was a Surly 1 x 1
and its speed was maintained by an electric hub motor (i.e. no pedaling) with
cruise control.

\begin{figure}
  \centering
  \includegraphics[width=\textwidth]{figures/torque-wrench-instrumentation.png}
  \caption{{\bf The instrumentation used to measure steering torque.}
    The left image depicts the steer tube attachment in which the torque wrench
    is mounted. The middle image shows the torque wrench's dial indicator,
    including the orange needle which gives the maximum torque value. The right
    image shows the camera mount and the handlebars with torque wrench
    installed.
    }
  \label{fig:torque-wrench-instrumentation}
\end{figure}

We recorded video data for two riders performing seven different maneuvers:

\begin{itemize}
  \item straight run into tracking a both half circles of radius 6 and 10
    meters,
  \item tracking a straight line,
  \item a 2 meter lane change,
  \item a slalom with 3 meter spacing between obstacles,
  \item and a steady circle tracking of both radius 5 and 10 meter circles.
\end{itemize}

After completing the experiments we viewed the videos and manually noted the
maximum and minimum torques for each run. We subjectively ignored outlier high
torque readings from abnormal accelerations, such as those due to riding over
bumps.

We recorded the run number, the rider’s estimate of the speed after the run in
miles per hour, the maximum value stored on the torque wrench after the run,
the rider’s name, the maneuver type, the minimum speed seen on the video
footage in miles per hour, the maximum speed seen on the video footage in miles
per hour, the maximum torque seen on the video footage in inch-lbs, and the
rotation sense for each run (+ for clockwise [right turn] and - for counter
clockwise [left turn]). The raw data can be accessed via Figshare~\cite{}
and the Internet Archive~\cite{}.

The histogram, Figure \ref{fig:twrench-torque-histogram}, shows that the
maximum torque in all runs never exceeded 5 Nm and Table
\ref{tab:maneuver-torque-values} gives the maximum and minimum torques for each
maneuver. Figure \ref{fig:twrench-torque-speed} shows all of the recorded
torques as a function of speed. There is some indication that there may be an
underlying dependency on speed, i.e. that the maximum torques decrease as speed
decreases.

\begin{figure}
  \centering
  \includegraphics[width=4in]{figures/twrench-torque-histogram.pdf}
  \caption{{\bf Histogram of the maximum recorded torques for all runs.}
    The median is around 2 Nm with torques measured up to 5 Nm. Generated by
    torque-wrench.R}
  \label{fig:twrench-torque-histogram}
\end{figure}

\begin{table}
  \caption{Maximum and minimum torques values for the different maneuvers.}
  \begin{tabular}{lrr}
    \toprule
    Maneuver & Maximum Torque [Nm] & Minimum Torque [Nm] \\
    \midrule
    Steady Circle (r = 10m) & 3.4 & -2.4 \\
    Steady Circle (r = 5m) & 2.4 & -2.2 \\
    Half Circle (r = 10m) & 3.8 & -5.0 \\
    Half Circle (r = 6m) & 3.4 & -5.0 \\
    Lane Change (2m) & 2.9 & -2.6 \\
    Line Tracking & 2.6 & -3.4 \\
    Slalom & 4.5 & -4.8 \\
    \bottomrule
  \end{tabular}
  \label{tab:maneuver-torque-values}
\end{table}

\begin{figure}
  \centering
  \includegraphics[width=6in]{figures/twrench-torque-speed.pdf}
  \caption{{\bf The maximum torques as for each run as a function of speed.}
    Generated by torque-wrench.R}
  \label{fig:twrench-torque-speed}
\end{figure}

From this data, we concluded that a torque sensor with a range of $\pm10$ Nm
should provide an adequate range with safety factor and still retain high
enough accuracy.

\section*{Isolated Steer Torque Measurement Design}

Our design is based on the floating handle bar with inline torque sensor but
takes special care to isolate the torque measurement from non-contributing
loads. The best torque transducer with an appropriate accuracy and range that
we found was a Futek (Irvine, CA, USA) 150 in-lb ($\pm 17$ Nm) TFF350 torque
sensor. This sensor ensures high accuracy for the low torques used in normal
bicycle maneuvering. To guarantee that torques are measured only about the
steer axis, we isolated the steer torque sensor from any of the non-axial
torques and all forces transmitted through the handlebar or ground contact with
a zero backlash telescoping double universal joint,
Figure~\ref{fig:steer-torque-design}. This universal joint only transmits motion
along the main axis and has negligible backlash.

\begin{figure}
  \centering
  \includegraphics[width=3in]{figures/steer-torque-design.png}
  \caption{{\bf The steer torque sensor isolation design.} The handlebars attach to
    the stem which is mounted in the upper bearings. The fork and steer tube
    are mounted in the normal headset of the bicycle. Between these two sets of
    bearings the stem is connected to the steer tube via the torque sensor and a
    zero backlash telescoping double universal joint. The steer angle and rate
    are measured at the steer tube and rate and acceleration of the rear frame
    are collected with the IMU.}
  \label{fig:steer-torque-design}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=4in]{figures/steer-assembly.jpg}
  \caption{{\bf Steer torque measurment assembly.} }
  \label{fig:steer-torque-design}
\end{figure}

The bicycle fork is mounted as normal in the headset bearings, which we will
call the ``lower'' headset bearings. A rigid frame 4130 frame structure was
welded to the bicycle frame to support the ``upper'' headset bearings. The
handlebar's steer tube was mounted in these tapered roller bearings directly
inline with the steer axis. The universal joint was attached to the fork's
steer tube. The torque sensor then connected the top of the universal joint
with the bottom of the handlebar stem. A slip clutch, which was ultimately
disabled during all of the experiments due to backlash, was mounted between the
pair of upper headset bearings to provide sensor overload protection. This
effectively isolated the torque sensor from all non-steer torque contributing
loads.

Additional sensors were also mounted on the rear frame and fork for kinematic
measurements needed for the inertial compensation. The relative angle between
the bicycle front frame and rear frame, steer angle, was measured with a
potentiometer. The body fixed angular rate of the front frame about the steer
axis was measured with a rate gyro. And the body fixed 3D angular rate and 3D
body fixed point acceleration of the rear frame was measured with an IMU.
Details of these sensors can be found in~\cite{Moore2012}.

% TODO : Report the accuracy of the sensor we chose.
% TODO : Add universal joint company
% TODO : Add a real picture of the final design to include beside the CAD
% drawing.
% TODO : Added slip clutch model and company.

\section*{Steer Dynamics}
\label{sec:steer-dynamics}

% TODO : Should the title of this section be ``Inertial Compensation''?

The final design placed the torque sensor inline with the steer axis inbetween
the lower and upper head set bearings. Thus, the measured torque $T_M$ from the
sensor is not the same as the effective input torque applied by the rider. But,
the rider applied steer torque $T_\delta$ can be shown to be a function of the
kinematics of both the front and rear frame and the friction torques generated
by the bearings.

A free body diagram can be drawn of the portion of the front frame assembly
above the torque sensor, Figure~\ref{fig:handlebar-free-body}. The torques
acting on the handlebar about the steer axis are the measured torque $T_M$, the
rider applied steer torque $T_\delta$, and the friction from the upper bearing
set $T_U$ which we describe by the sum of Coulomb $T_{U_F}$ and viscous
friction $T_{U_V}$.

\begin{figure}
  \centering
  \includegraphics{figures/handlebar-free-body.pdf}
  \caption{{\bf A free body diagram of the handlebar, $G$, with all axial torques
    shown.} The rear frame $B$ has arbitrary orientation with respect to the
    Newtonian reference frame $N$. The handlebar rotates about $\hat{b}_3$ with
    respect to the rear frame. Gravity $g$ is in the $\hat{n}_3$ direction. The
    rider applies forces to the handlebars, resulting in a component of torque
    $T_\delta$ about the steer axis. This torque is resisted by the upper
    bearing friction $T_U$, the measured torque at the sensor $T_M$, the
    inertia of the handlebar, and the gravitational force acting on the
    handlebar center of mass $g_o$. The three distances, $d$, $d_{s1}$, and
    $d_{s3}$ locate the handlebar center of mass with respect to the center of
    the IMU.}
  \label{fig:handlebar-free-body}
\end{figure}

We measure three components of body fixed angular rate of the bicycle rear
frame $B$ in the Newtonian reference frame $N$ with the three IMU rate gyros.
Using $\mathbf{b}_{1},\mathbf{b}_{2},\mathbf{b}_{3}$ as $B$'s orthonormal unit
vectors, this is expressed as
%
\begin{equation}
  ^N\boldsymbol{\omega}^B = \omega_{b1}\hat{\mathbf{b}}_1 +
                            \omega_{b2}\hat{\mathbf{b}}_2 +
                            \omega_{b3}\hat{\mathbf{b}}_3
  \label{eq:rear-frame-angular-rate}
\end{equation}

The handlebar, frame $G$, is connected to the bicycle rear frame $B$ by a
revolute joint that rotates through the steering angle $\delta$ about the
$\hat{\mathbf{g}_3}$ axis and we measure both the steer angle with a
potentiometer and a component of the body fixed inertial angular rate of the
handlebar $\omega_{g3}$ about the steer axis with a rate gyro. The angular
velocity of the handlebar can be written as
%
\begin{equation}
  ^N\boldsymbol{\omega}^G =
    (\omega_{b1}c_\delta + \omega_{b2}s_\delta)\hat{\mathbf{g}}_1 +
    (-\omega_{b1}s_\delta + \omega_{b2}c_\delta)\hat{\mathbf{g}}_2 +
    \omega_{g3}\hat{\mathbf{g}}_3
\end{equation}
%
where $c_\delta$ and $s_\delta$ are shorthand for $\operatorname{cos}(\delta)$
and $\operatorname{sin}(\delta)$ respectively.

The steer rate, $\dot{\delta}$, can be computed from the measurments by
subtracting the angular rate of the bicycle rear frame about the steer axis
from the angular rate of the handlebar about the steer axis.
%
\begin{equation}
  \dot{\delta} \hat{\mathbf{b}}_3 = \omega_{g3} \hat{\mathbf{b}}_3 - \omega_{b3} \hat{\mathbf{b}}_3
\end{equation}

Now we define a point $s$ on the steer axis a minimum distance $d$ from the
center of mass of the handlebar $g_o$.
%
\begin{equation}
  \mathbf{r}^{g_o/s} = d\hat{\mathbf{g}}_1
\end{equation}

We also measure the body fixed acceleration of a point $v$ in $N$ on the
bicycle frame with the IMU accelerometers which includes the acceleration due
to gravity. This can be expressed as
%
\begin{equation}
  ^N\mathbf{a}^v =
    a_{v1}\hat{\mathbf{b}}_1 +
    a_{v2}\hat{\mathbf{b}}_2 +
    a_{v3}\hat{\mathbf{b}}_3
  \label{eq:acceleration-of-v}
\end{equation}

The location of point $v$ is known with respect to $s$
%
\begin{equation}
  \mathbf{r}^{s/v} = d_{s1}\hat{\mathbf{b}}_1 + d_{s3}\hat{\mathbf{b}}_3
\end{equation}

The acceleration of the handlebar's center of mass, $^N\mathbf{a}^{g_o}$, can
now be calculated using the two point theorem for acceleration \cite{Kane1985}
twice starting at the point $v$:
%
\begin{equation}
  ^N\mathbf{a}^s = {}^N\mathbf{a}^v +
    {}^N\dot{\boldsymbol{\omega}}^B\times\mathbf{r}^{s/v} +
    {}^N\boldsymbol{\omega}^B\times({}^N\boldsymbol{\omega}^B\times\mathbf{r}^{s/v})
\end{equation}

\begin{equation}
  ^N\mathbf{a}^{g_o} = {}^N\mathbf{a}^s +
    {}^N\dot{\boldsymbol{\omega}}^G\times\mathbf{r}^{g_o/s} +
    {}^N\boldsymbol{\omega}^G\times({}^N\boldsymbol{\omega}^G\times\mathbf{r}^{g_o/s})
\end{equation}

The angular momentum of the handlebar about its center of mass is defined as
%
\begin{equation}
  ^N\mathbf{H}^{G/g_o} = I^{G/g_o} \cdot {}^N\boldsymbol{\omega}^G
\end{equation}
%
where $I^{G/g_o}$ is the inertia dyadic of the handlebar with reference to its
center of mass. We assume that the handlebar exhibits symmetry about the plane
normal to $\hat{\mathbf{g}}_2$, simplifying the inertia dyadic to
%
\begin{equation}
  I^{G/g_o} =
    I_{G_{11}} \hat{\mathbf{g}}_1 \otimes \hat{\mathbf{g}}_1 +
    I_{G_{22}} \hat{\mathbf{g}}_2 \otimes \hat{\mathbf{g}}_2 +
    I_{G_{33}} \hat{\mathbf{g}}_3 \otimes \hat{\mathbf{g}}_3 +
    I_{G_{31}} \hat{\mathbf{g}}_1 \otimes \hat{\mathbf{g}}_3 +
    I_{G_{31}} \hat{\mathbf{g}}_3 \otimes \hat{\mathbf{g}}_1
\end{equation}

Now the dynamic equations of motion of the handlebar can be written as the sum
of the torques on the handlebar about point $s$ is equal to the derivative of
the angular momentum of $G$ in $N$ about $g_o$ plus the cross product of the
vector from $s$ to $g_o$ with the mass times the acceleration of $g_o$ in $N$
\cite{Meriam1975}. We neglect the gravitational torque because it is already
accounted for in the measured linear acceleration,
Equation~\ref{eq:acceleration-of-v}.
%
\begin{equation}
  \sum \mathbf{T}^{G/s} = {}^N\dot{\mathbf{H}}^{G/g_o} +
    \mathbf{r}^{g_o/s} \times m_G\,{}^N\mathbf{a}^{g_o}
\end{equation}

We are only interested in the components of the previous equation in which the
steer torque appears, so only the torques about the steer axis are examined.
%
\begin{equation}
  \sum T^{G/s}_3 = T_\delta - T_U - T_M = \left({}^N\dot{\mathbf{H}}^{G/g_o} +
  \mathbf{r}^{g_o/s} \times m_G\,{}^N\mathbf{a}^{g_o}\right) \cdot \hat{\mathbf{g}}_3
\end{equation}

At this stage the rider's applied steer torque, $T_\delta$, can be solved for,
giving
%
\begin{align}
  T_{\delta} =
    & I_{G_{22}} \left[ \left( -\omega_{b1} s_\delta + \omega_{b2} c_\delta \right)
      c_\delta + \omega_{b2} s_\delta \right] + I_{G_{33}} \dot{\omega}_{g3} + \nonumber \\
    & I_{G_{31}} \left[ (-\omega_{g3} + \omega_{b3} ) \omega_{b1} s_\delta +
      (-\omega_{b3} + \omega_{g3}) \omega_{b2} c_\delta +
      s_\delta \dot{\omega}_{b2} + c_\delta \dot{\omega}_{b1} \right] + \nonumber \\
    & \left[ I_{G_{11}} (\omega_{b1} c_\delta + \omega_{b2}s_\delta) +
      I_{G_{31}} \omega_{g3} \right] \left[-\omega_{b1} s_\delta +
      \omega_{b2} c_\delta \right] + \nonumber \\
    & d m_G \left[ d (-\omega_{b1} s_\delta + \omega_{b2} c_\delta)
      (\omega_{b1} c_\delta + \omega_{b2} s_\delta) + d \dot{\omega}_{g3} \right] - \nonumber \\
    & d m_G \left[-d_{s1} \omega_{b2}^{2} + d_{s3} \dot{\omega}_{b2} -
      (d_{s1} \omega_{b3} - d_{s3} \omega_{b1}) \omega_{b3} + a_{v1} \right] s_\delta + \nonumber \\
    & d m_G \left[d_{s1} \omega_{b1} \omega_{b2} + d_{s1} \dot{\omega}_{b3} +
      d_{s3} \omega_{b2} \omega_{b3} - d_{s3} \dot{\omega}_{b1} + a_{v2} \right]
      c_\delta + \nonumber \\
    & T_U + T_M
    \label{eq:steer-torque}
\end{align}

All for the variables which are constant with respect to time in can be
measured directly, see Table~\ref{tab:numerical-constants} for the values.
These distance, mass, and inertia values are measured as described in
\cite{Moore2012}. All time varying terms in Equation~\ref{eq:steer-torque} are
either measured directly by the on-board sensors or can be calculated with
numerical differentiation. The only excepton is the upper bearing frictional
torque, $T_U$. We estimate this torque contribution through experiments
described in the following section.

\begin{table}
  \centering
  \caption{Numerical values for the constant parameters in Equation
    \ref{eq:steer-torque} for the instrumented bicycle used in the experiments.
    These values were obtained by the measurements explained in
    \cite{Moore2012}.}
  \begin{tabular}{lll}
    \toprule
    Variable     & Value  & Unit \\
    \midrule
    $d$          & 0.963  & m\\
    $d_{s1}$     & 0.135  & m \\
    $d_{s3}$     & -0.360 & m \\
    $m_G$        & 3.35   & kg \\
    $I_{G_{11}}$ & 0.0497 & $kg \cdot m^2$ \\
    $I_{G_{13}}$ & 0.0049 & $kg \cdot m^2$ \\
    $I_{G_{22}}$ & 0.0174 & $kg \cdot m^2$ \\
    $I_{G_{33}}$ & 0.0622 & $kg \cdot m^2$ \\
    \bottomrule
  \end{tabular}
  \label{tab:numerical-constants}
\end{table}

\section*{Estimation of Bearing Friction}
\label{sec:bearing-friction}

In our design, the torque sensor is mounted between two sets of bearings. The
upper set for the handlebars are tapered roller bearings and the lower are
typical bicycle headset bearings. Each are preloaded a nominal amount during
installation. We assume that the rotary friction due to each bearing set can be
described as the sum of viscous $T_{Bv}$ and Coulomb friction $T_{Bc}$. The
Coulomb friction can be described as a piecewise-constant function of the
steering rate, Equation~\ref{eq:coulomb}, and viscous friction is a linear
function of the steer rate, Equation~\ref{eq:viscous}.

\begin{equation}
  T_{Bc} = t_B \operatorname{sgn}(\dot\delta) =
  \begin{cases}
    t_B  & \textrm{if $\dot{\delta}>0$}\\
    0    & \textrm{if $\dot{\delta}=0$}\\
    -t_B & \textrm{if $\dot{\delta}<0$}
  \end{cases}
  \label{eq:coulomb}
\end{equation}

\begin{equation}
  \label{eq:viscous}
  T_{Bv} = c_B \dot{\delta}
\end{equation}

The total friction due to all four bearings in the headsets is

\begin{equation}
  T_B = T_{Bc} + T_{Bv}
\end{equation}

To estimate the coefficients $t_B$ and $c_B$, we mounted the bicycle with the
steer axis vertical, the front wheel off the ground, and the rear frame rigidly
fixed in inertial space. We then attached two parallel springs of stiffness $k$
to the left handlebar so that the force from the springs acted through lever
arm $l$ relative to the steer axis.

% TODO : Add a diagram or image of the experimental setup.

This configuration allowed application of small perturbations to the handlebars
and subsequent measurement of the damped vibrations in the steer angle
$\delta$, steer rate $\dot{\delta}$, and steer tube torque $T_M$. The equations
of motion governing the system then become
%
\begin{equation}
  I_{HF} \ddot{\delta} + c_B \dot{\delta} + t_B
  \operatorname{sgn}(\dot{\delta}) + 2 k l^2 \delta = 0
\end{equation}
%
where $I_{HF}$ is the total moment of inertia of the combined front frame and
front wheel.

We measured the lever arm and spring stiffness as 0.213 meters and $904.7 \pm
0.6$ N/m respectively. The inertia of the handlebar, fork, and front wheel
about the steer axis, $I_{HF}$, was estimated based on the measurements
described in \cite{Moore2012} and found to be $0.1297+/-0.0005$ $kg\cdot m^2$

We estimated the friction coefficients with a non-linear grey box
identification based on the measured steer angle over 15 trials in which the
steering assembly was perturbed from equilibrium. The identified viscous
coefficient is $c_B = 0.34 \pm 0.04$ $N \cdot m \cdot s^2$ and the Coulomb
coefficient is $t_B = 0.15 \pm 0.05$ $N \cdot m$.

To calculate the applied steer torque $T_\delta$ we need an estimate of the
upper bearing friction $T_U$ and at this point we only have the total friction
from both the lower and upper bearings. We made the simple assumption that the
friction in the upper and lower bearings are equal, $T_U = T_B / 2$, due to
indeterminacy of the upper and lower bearing friction individually from the
steer tube torque measurement; see \cite{Moore2012} for details. It is
important to note that the upper bearings are preloaded, but that no other
signficant axial loads are applied in normal riding, thus our estimate of the
upper bearing friction is not dependent on having the wheel contact loaded
during these experiments.

% TODO : Maybe I should show a plot of one of the fits or something.

\section*{Steer Torque Predictions}

Using the equations described in section \ref{sec:steer-dynamics} and the
estimates for the upper bearing friction coefficients in
\ref{sec:bearing-friction} we compute the compensated steer torque for 359
trials from the data collected from the instrumented bicycle set presented in
\cite{Moore2012}. Figure~\ref{fig:steer-torque-components} gives results from
an example trial. We then compute the root mean square of the error between
the torque from the sensor and the compensated torque for each trial. We also
compute the maximum of the absolute value of the error for each trial and the
coefficient of determination (i.e. $R^2$) between the compensated and
uncompensated torques. Outliers outside of $\pm2 \sigma$ were excluded from
the results. Figure \ref{fig:error-stats} shows the distribution of these
statistics. The median values of the three statistics are given in
Table~\ref{tab:medians}.

\begin{figure}
  \centering
  \includegraphics{figures/steer-torque-components.pdf}
  \caption{{\bf Steer torque measurements and the computed compensation for Trial \#
    700.}}
  \label{fig:steer-torque-components}
\end{figure}

\begin{figure}
  \centering
  \includegraphics{figures/error-stats.pdf}
  \caption{{\bf Histograms of the three statistics for all 359 trials.}}
  \label{fig:error-stats}
\end{figure}

\begin{table}
  \caption{{\bf The median and maximum value of the error statistics.}}
  \centering
  \begin{tabular}{lrr}
    \hline
    Statistic                    & Median   & Maximum \\
    \hline
    Coefficient of Determination & 0.728814 & 0.822647 \\
    Maximum Error                & 2.446387 & 6.588228 \\
    RMS of the Errors            & 0.466733 & 0.899118
  \end{tabular}
  \label{tab:medians}
\end{table}

\section*{Discussion}

For the bicycle and maneuvers performed in the experiments herein we have shown
that neglecting to compensate for inertial effects can have a large influence
on the accuracy of the results. In particular, on median 28\% of the actual
torque applied by the rider in our experiments would be neglected. This may be
less important for motorcycles because the nominal steer torques are usually
much larger, but this error will always be significant for measurements of low
torque ($<$ 20 Nm or so) in any vehicle. Steer torque sensor designs should
account for the inertial effects of the handlebars and eliminate crosstalk for
high accuracy. Ideally, one would measure the forces at the hand/handlebar
interface with very accurate six component load cells and inertial compensation
would not be necessary. The closer the sensor is to the rider's hands the less
important inertial compensation becomes. But if more traditional direct steer
torque measurements are used, both inertial compensation and cross talk
mitigation (mechanically or computationally) will be needed. We have found only
a couple of designs that mitigate the inertial issue before us, namely
\cite{Evertse2010} and \cite{Iuchi2006}, and many previous design were aware of
crosstalk, but no design shows complete elimination as we have. Maneuvers with
high steer accelerations and high handlebar axial moments of inertia are
especially susceptible, due to the dominance of the effects of angular
acceleration on torque. This is clearly shown in
Figure~\ref{fig:steer-torque-components}. Our design gave very accurate torque
measurements, but there is still much room for improvement, especially in terms
of complexity and cost. Creating a simple, inexpensive, and accurate steer
torque measurement system could play an important role in assistive control
system design in production vehicles.

\section*{Acknowledgements}

This paper is based on work supported by the National Science Foundation under
Grant No. 0928339. Thanks to Peter de Lange for developing the bearing friction
experimental protocol and analysis, Gilbert Gede and Mohammed Osman for
assistance in constructions and design, and to Ton van den Bogert for comments
and review.

\bibliographystyle{unsrt}
\bibliography{references}

\end{document}
